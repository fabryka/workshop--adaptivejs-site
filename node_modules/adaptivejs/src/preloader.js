define([
    // Built from files in app/preload
    'text!preload-css',
    'text!preload-html',
    'text!preload-js',
    'adaptivejs/utils/buildOrigin'
], function(preloadCss, preloadHtml, preloadJs, buildOrigin) {
    return function() {
        var head = document.getElementsByTagName('head');
        var body = document.getElementsByTagName('body');

        // Some older browsers throw exceptions if document.head/document.body doesn't exist
        if (!head.length || !body.length) {
            return;
        }

        head = head[0];
        body = body[0];

        var style = document.createElement('style');
        var container = document.createElement('div');
        var scriptEl = document.createElement('script');
        var meta = document.createElement('meta');

        meta.name = 'viewport';
        meta.content = 'width=device-width';

        style.className = 'capture-remove';
        container.className = 'preloader capture-remove';
        scriptEl.className = 'capture-remove';

        style.innerHTML = preloadCss;
        container.innerHTML = preloadHtml;
        scriptEl.innerHTML = preloadJs;

        head.appendChild(meta);
        head.appendChild(style);

        body.appendChild(container);
        head.appendChild(scriptEl);
    };
});
